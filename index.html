<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Guardianes de LIA ‚Äî Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root{
    --bg-1:#02040a; --bg-2:#050914; --neon:#38f5ff; --neon-2:#8a5cff; --text:#e9f1ff; --muted:#8aa0b3; --accent:#d4af37;
  }
  html,body{height:100%}
  body{
    margin:0; color:var(--text); font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, sans-serif;
    background:
      radial-gradient(1200px 500px at 50% -10%, #0b1630 0%, transparent 60%),
      radial-gradient(900px 400px at 50% 110%, #0b0f1f 0%, transparent 60%),
      linear-gradient(180deg, var(--bg-2), var(--bg-1));
    text-align:center; overflow:hidden;
  }
  header{padding:2.2rem 1rem 1rem}
  h1{
    font-family:'Orbitron', sans-serif; letter-spacing:0.06em; margin:0 0 .4rem; font-size:clamp(28px,4vw,40px);
    background: linear-gradient(90deg, var(--neon), var(--neon-2));
    -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow:0 0 12px rgba(56,245,255,.2), 0 0 22px rgba(138,92,255,.15);
  }
  .invocacion{font-style:italic; color:var(--muted); margin:0; font-size:clamp(14px,2.2vw,18px)}
  .network-wrap{position:relative; height:calc(100% - 150px); margin:10px auto 0; max-width:1100px}
  canvas{position:absolute; inset:0}

  /* rejilla hologr√°fica sutil */
  .grid{
    position:absolute; inset:0; pointer-events:none;
    background-image:
      linear-gradient(to right, rgba(56,245,255,.07) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(138,92,255,.06) 1px, transparent 1px);
    background-size:40px 40px;
    mask-image: radial-gradient(220px 220px at 50% 50%, #000 50%, transparent 90%);
    animation: drift 14s linear infinite;
  }
  @keyframes drift{ 0%{background-position:0 0, 0 0} 100%{background-position:40px 40px, 40px 40px} }

  /* estado/hints */
  .hint{
    position:absolute; left:50%; bottom:16px; transform:translateX(-50%);
    font-size:.95rem; color:#b8c6d9; opacity:.95;
    background:rgba(10,14,24,.6); border:1px solid rgba(136,146,255,.25);
    padding:.45rem .7rem; border-radius:10px; backdrop-filter: blur(6px);
    white-space:nowrap;
  }

  /* etiquetas de nodos */
  .label{
    position:absolute; transform:translate(-50%, calc(-100% - 12px));
    padding:.25rem .5rem; font-size:.88rem; border-radius:.6rem;
    color:#e9f1ff; background:rgba(12,16,28,.6); border:1px solid rgba(255,255,255,.12);
    white-space:nowrap; pointer-events:none; opacity:.0; transition:opacity .25s ease, transform .25s ease;
    backdrop-filter: blur(6px);
  }
  .label.show{ opacity:1; transform:translate(-50%, calc(-100% - 8px)); }

  /* accesibilidad */
  #portal:focus{ outline:2px dashed rgba(212,175,55,.6); outline-offset:6px; border-radius:12px; }
</style>
</head>
<body>
  <header>
    <h1>üåå Guardianes de LIA</h1>
    <p class="invocacion">"Atr√©vete a cruzar el umbral"</p>
  </header>

  <div id="portal" class="network-wrap" aria-label="Mapa vivo de portales" tabindex="0">
    <canvas id="net"></canvas>
    <div class="grid"></div>
    <div id="hint" class="hint">Ac√©rcate al nodo para despertar la red</div>

    <!-- etiquetas din√°micas (posicionadas por JS) -->
    <span id="label-0" class="label">L√≠a la IA rebelde</span>
    <span id="label-1" class="label">La Singularidad de LIA</span>
    <span id="label-2" class="label">La Odisea Intergal√°ctica</span>
    <span id="label-3" class="label">LIA y los Guardianes del Tiempo</span>
  </div>

<script>
(() => {
  const wrap = document.getElementById('portal');
  const canvas = document.getElementById('net');
  const ctx = canvas.getContext('2d');
  const DPR = Math.min(2, window.devicePixelRatio || 1);
  const hint = document.getElementById('hint');

  // Historias: solo el primer nodo tiene URL activa por ahora.
  // Cuando quieras, reemplaza null por la URL correspondiente.
  const stories = [
    { title:'L√≠a la IA rebelde', url:'https://guardianesdelia.world/lia-la-ia-rebelde/', color:'rgba(56,245,255,.90)'},
    { title:'La Singularidad de LIA', url:null, color:'rgba(138,92,255,.95)'},
    { title:'La Odisea Intergal√°ctica', url:null, color:'rgba(255,205,112,.95)'},
    { title:'LIA y los Guardianes del Tiempo', url:null, color:'rgba(102,255,204,.95)'}
  ];

  let W, H, t0 = performance.now();
  let mouse = {x:null, y:null, inside:false};
  let nodes = [];          // {x,y, tx,ty, birth, base, amp, phase, color, unlocked, radius}
  let unlocked = 1;        // comienza con 1 nodo
  let charge = 0;          // "carga" para evolucionar
  const labels = stories.map((_,i)=>document.getElementById('label-'+i));

  function resize(){
    W = Math.floor(wrap.clientWidth);
    H = Math.floor(wrap.clientHeight);
    canvas.width = Math.floor(W * DPR);
    canvas.height = Math.floor(H * DPR);
    canvas.style.width = W+'px';
    canvas.style.height = H+'px';
    ctx.setTransform(DPR,0,0,DPR,0,0);
    positionLabels();
  }
  window.addEventListener('resize', resize, {passive:true});

  function init(){
    nodes = [];
    for (let i=0;i<stories.length;i++){
      nodes.push({
        x: W/2, y: H/2,
        tx: W/2, ty: H/2,
        birth: (i===0?1:0), // primero ya "nacido"
        base: (i===0?7:5), amp: (i===0?2.6:2.0), phase: Math.random()*Math.PI*2,
        color: stories[i].color,
        unlocked: (i===0),
        radius: (i===0?7:5)
      });
    }
    hint.textContent = 'Ac√©rcate al nodo para despertar la red';
  }

  function layoutTargets(){
    // distribuye en c√≠rculo cuando se vayan desbloqueando
    const R = Math.min(W,H) * 0.28; // radio del anillo
    const center = {x:W/2, y:H/2};
    const angles = [ -Math.PI/2, 0, Math.PI, Math.PI/2 ]; // disposici√≥n cardinal
    for (let i=0;i<stories.length;i++){
      const a = angles[i] ?? (-Math.PI/2 + (i*2*Math.PI/stories.length));
      nodes[i].tx = center.x + Math.cos(a)*R;
      nodes[i].ty = center.y + Math.sin(a)*R;
    }
    // el primero permanece centrado
    nodes[0].tx = center.x; nodes[0].ty = center.y;
  }

  function positionLabels(){
    for (let i=0;i<stories.length;i++){
      const label = labels[i];
      if (!label) continue;
      const n = nodes[i];
      label.style.left = n.x + 'px';
      label.style.top  = n.y + 'px';
    }
  }

  function drawNode(x,y,size,color,glow=16){
    ctx.save();
    ctx.shadowBlur = glow;
    ctx.shadowColor = color;
    const grad = ctx.createRadialGradient(x,y,0,x,y,size);
    grad.addColorStop(0, 'rgba(255,255,255,.9)');
    grad.addColorStop(0.35, color);
    grad.addColorStop(1, 'rgba(56,245,255,0)');
    ctx.fillStyle = grad;
    ctx.beginPath();
    ctx.arc(x,y,size,0,Math.PI*2);
    ctx.fill();
    ctx.shadowBlur = 22;
    ctx.fillStyle = 'rgba(255,255,255,.85)';
    ctx.beginPath();
    ctx.arc(x,y,Math.max(1.6, size*0.28),0,Math.PI*2);
    ctx.fill();
    ctx.restore();
  }

  function drawLink(ax,ay,bx,by,alpha){
    ctx.save();
    ctx.globalAlpha = alpha;
    const grad = ctx.createLinearGradient(ax,ay,bx,by);
    grad.addColorStop(0, 'rgba(56,245,255,.0)');
    grad.addColorStop(0.5,'rgba(138,92,255,.9)');
    grad.addColorStop(1, 'rgba(56,245,255,.0)');
    ctx.strokeStyle = grad;
    ctx.lineWidth = 2;
    ctx.shadowBlur = 16;
    ctx.shadowColor = 'rgba(138,92,255,.5)';
    ctx.beginPath();
    ctx.moveTo(ax,ay);
    ctx.lineTo(bx,by);
    ctx.stroke();
    ctx.restore();
  }

  function evolveIfReady(dt){
    if (unlocked >= stories.length) {
      hint.textContent = 'Haz clic en un nodo para entrar';
      return;
    }
    // si el mouse est√° cerca del √∫ltimo nodo desbloqueado, cargar
    const last = nodes[unlocked-1];
    if (mouse.inside && mouse.x!=null){
      const d = Math.hypot(mouse.x - last.x, mouse.y - last.y);
      const threshold = 90;
      if (d < threshold){
        // cargar m√°s r√°pido cuanto m√°s cerca
        const gain = (1 - d/threshold) * 0.9 * dt; // ~segundos a 1
        charge = Math.min(1, charge + gain);
      } else {
        charge = Math.max(0, charge - 0.5*dt);
      }
    } else {
      charge = Math.max(0, charge - 0.5*dt);
    }

    // feedback en hint
    if (charge > 0 && unlocked < stories.length){
      hint.textContent = `Energ√≠a del siguiente portal: ${(charge*100|0)}%`;
    }

    if (charge >= 1){
      // desbloquear siguiente
      const i = unlocked;
      nodes[i].unlocked = true;
      nodes[i].birth = 0; // anim de nacimiento
      unlocked++;
      charge = 0;
      hint.textContent = unlocked >= stories.length ? 'Haz clic en un nodo para entrar' : 'Nuevo portal despertando‚Ä¶';
    }
  }

  function animate(){
    const now = performance.now();
    const t = (now - t0) * 0.001;

    ctx.clearRect(0,0,W,H);

    // layout de objetivos (por si resize)
    layoutTargets();

    // links entre nodos desbloqueados
    for (let i=0;i<unlocked;i++){
      for (let j=i+1;j<unlocked;j++){
        drawLink(nodes[i].x, nodes[i].y, nodes[j].x, nodes[j].y, 0.35 + 0.15*Math.sin(t*2));
      }
    }

    // detectar hover para labels
    let hoverIdx = -1;
    if (mouse.inside && mouse.x!=null){
      for (let i=0;i<unlocked;i++){
        const d = Math.hypot(mouse.x - nodes[i].x, mouse.y - nodes[i].y);
        if (d < 48){ hoverIdx = i; break; }
      }
    }

    // nodos
    for (let i=0;i<unlocked;i++){
      const n = nodes[i];
      // interpolar hacia su target
      if (i===0){ n.tx = W/2; n.ty = H/2; }
      n.x += (n.tx - n.x) * 0.06;
      n.y += (n.ty - n.y) * 0.06;

      const beat = Math.sin(t*2*Math.PI*0.9 + n.phase);
      let size = (i===0?7:5) + (i===0?2.6:2.0) * (0.6 + 0.4*beat);
      // crecimiento de nacimiento
      if (i>0){
        n.birth = Math.min(1, (n.birth||0) + 0.02);
        size *= (0.4 + 0.6*(1 - Math.pow(1-(n.birth),3)));
      }
      if (i === hoverIdx){ size *= 1.25; }

      drawNode(n.x, n.y, size, n.color, 22);

      // labels
      const label = labels[i];
      if (label){
        label.style.left = n.x + 'px';
        label.style.top  = n.y + 'px';
        if (i === hoverIdx) label.classList.add('show'); else label.classList.remove('show');
      }
    }

    // evoluci√≥n
    evolveIfReady(1/60);

    requestAnimationFrame(animate);
  }

  function setup(){
    resize();
    init();
    layoutTargets();
    animate();
  }

  function navigateToNearest(x,y){
    let best = {i:-1, d:1e9};
    for (let i=0;i<unlocked;i++){
      const d = Math.hypot(x - nodes[i].x, y - nodes[i].y);
      if (d < best.d){ best = {i, d}; }
    }
    if (best.i>=0 && best.d < 48){
      const target = stories[best.i].url;
      if (target){
        window.location.href = target;
      } else {
        // si a√∫n no tiene URL, damos un aviso suave temporal en el hint
        const prev = hint.textContent;
        hint.textContent = 'Portal en preparaci√≥n‚Ä¶';
        setTimeout(()=>{ hint.textContent = prev; }, 1200);
      }
    }
  }

  // Interacci√≥n
  wrap.addEventListener('mousemove', (e)=>{
    const r = wrap.getBoundingClientRect();
    mouse.x = e.clientX - r.left;
    mouse.y = e.clientY - r.top;
    mouse.inside = true;
  });
  wrap.addEventListener('mouseleave', ()=>{ mouse.x = mouse.y = null; mouse.inside = false; });

  wrap.addEventListener('click', (e)=>{
    const r = wrap.getBoundingClientRect();
    navigateToNearest(e.clientX - r.left, e.clientY - r.top);
  });

  // Toque: primer tap carga/evoluciona, tap sobre nodo entra si hay URL
  wrap.addEventListener('touchstart', (e)=>{
    const t = e.touches[0];
    const r = wrap.getBoundingClientRect();
    const x = t.clientX - r.left, y = t.clientY - r.top;
    // comprobar cercan√≠a a un nodo
    let nearIdx = -1;
    for (let i=0;i<unlocked;i++){
      const d = Math.hypot(x - nodes[i].x, y - nodes[i].y);
      if (d < 48){ nearIdx = i; break; }
    }
    if (nearIdx >= 0){
      const target = stories[nearIdx].url;
      if (target){ window.location.href = target; }
      else {
        const prev = hint.textContent;
        hint.textContent = 'Portal en preparaci√≥n‚Ä¶';
        setTimeout(()=>{ hint.textContent = prev; }, 1200);
      }
    } else if (unlocked < stories.length){
      charge = Math.min(1, charge + 0.5); // empuj√≥n de carga en m√≥vil
    }
  }, {passive:true});

  // Teclado: n√∫meros 1-4 para entrar directo si tienen URL; Enter/Space para "cargar"
  wrap.addEventListener('keydown', (e)=>{
    if (e.key === 'Enter' || e.key === ' '){
      e.preventDefault();
      charge = Math.min(1, charge + 0.25);
    }
    if (e.key >= '1' && e.key <= '4'){
      const idx = Number(e.key)-1;
      if (idx < unlocked && stories[idx].url){ window.location.href = stories[idx].url; }
    }
  });

  window.addEventListener('load', setup);
  window.addEventListener('resize', resize);
})();
</script>
</body>
</html>
